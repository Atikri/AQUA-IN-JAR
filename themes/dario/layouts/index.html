{{- define "main" }}
    {{- with .Site.GetPage "_index.md" }}
        {{- if .Params.homePageIsPost }}
    <h1>{{ .Title }}</h1>
    <h4>{{ .Params.description }}</h4>
    <p class="author-date"><time datetime="{{ .Date }}">{{ .Date.Format "January 2, 2006" }}</time> - {{ .Params.author }}</p>

            {{- if not (.Param "disableAnchoredHeadings") }}

{{ partial "anchored_headings.html" .Content }}

            {{- else }}

{{ .Content }}

            {{- end }}
        {{- else }}
            {{- $subtitle := .Params.subtitle }}
            {{- with .Content }}
    <section>
    <h1 class="smaller">{{ $subtitle | emojify }}</h1>
{{ . }}
    </section>
            {{- end }}
        {{- end }}
    {{- end }}

    <!-- Search Section -->
    <section id="search-section" class="search-section">
        <h2>{{ "Search Articles :turtle:" | emojify }}</h2>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®è¯æœç´¢..." class="search-input">
            <div id="searchResults" class="search-results"></div>
        </div>
    </section>

    <!-- Categories Section -->
    <section id="categories-section" class="categories-section">
        <h2>åˆ†ç±»æµè§ˆ</h2>
        <div class="categories-grid">
            <div class="category-card">
                <h3><a href="{{ "notification-jar/" | relURL }}">ğŸ“¢ Notification Jar</a></h3>
                <p>é€šçŸ¥ç½å­ - è®°å½•é‡è¦çš„é€šçŸ¥å’Œæé†’</p>
            </div>
            <div class="category-card">
                <h3><a href="{{ "aquas-field/" | relURL }}">ğŸŒ¾ Aqua's Field</a></h3>
                <p>æ°´ä¹‹ç”°é‡ - åˆ›æ„å’Œçµæ„Ÿçš„æºæ³‰</p>
            </div>
            <div class="category-card">
                <h3><a href="{{ "podcast-music/" | relURL }}">ğŸ§ Podcast & Music</a></h3>
                <p>æ’­å®¢ä¸éŸ³ä¹ï¼šæ”¶å½•éŸ³é¢‘èŠ‚ç›®ä¸ä¹æ›²</p>
            </div>
            <div class="category-card">
                <h3><a href="#" onclick="randomArticle()">ğŸ² Random Aqua</a></h3>
                <p>éšæœºè·³è½¬åˆ°ä¸€ç¯‡æ–‡ç« </p>
            </div>
        </div>
    </section>

    {{- range sort (where .Site.Sections "Section" "in" .Site.MainSections) "Weight" }}
    <section>
    <h2>{{ .Title }}</h2>
    <ul>
        {{- range where .Site.RegularPages "Section" .Section }}
        <li><a href="{{ .Permalink }}">{{ .Title }}</a></li>
        {{- end }}
    </ul>
    </section>
    {{- end }}

    <!-- Random Article JavaScript -->
    <script>
        function randomArticle() {
            // è·å–æ‰€æœ‰æ–‡ç« çš„URL
            const articles = [
                {{- range where .Site.RegularPages "Type" "posts" }}
                "{{ .Permalink }}",
                {{- end }}
                {{- range where .Site.RegularPages "Type" "aquas-field" }}
                "{{ .Permalink }}",
                {{- end }}
                {{- range where .Site.RegularPages "Type" "notification-jar" }}
                "{{ .Permalink }}",
                {{- end }}
                {{- range where .Site.RegularPages "Type" "podcast-music" }}
                "{{ .Permalink }}",
                {{- end }}
            ];
            
            // è¿‡æ»¤æ‰ç©ºå€¼
            const validArticles = articles.filter(url => url && url.trim() !== '');
            
            if (validArticles.length > 0) {
                // éšæœºé€‰æ‹©ä¸€ä¸ªæ–‡ç« 
                const randomIndex = Math.floor(Math.random() * validArticles.length);
                const randomUrl = validArticles[randomIndex];
                
                // è·³è½¬åˆ°éšæœºæ–‡ç« 
                window.location.href = randomUrl;
            } else {
                alert('æš‚æ—¶æ²¡æœ‰å¯ç”¨çš„æ–‡ç« ');
            }
        }
    </script>
{{- end }}
